-- Resumo da Se√ß√£o 5: Aprendizado Supervisionado: Regress√£o - Machine Learning com Python --

Nessa secao, iremos aborda o conteudo de aprendizado supervisionado focado na regressao

Supervisionada -> Regress√£o -> Previs√£o ou predi√ß√£o de um valor num√©rico.

Utiliza os dados de entrada para treinar um algoritmo de Machine Learning e, assim, prever uma resposta num√©rica.

DADOS DE ENTRADA -> ALGORITMO Aprendizagem Supervisionada -> PREVIS√ÉO

Algoritmos de Regress√£o:
Regress√£o Linear
Simples
Regress√£o Linear M√∫ltipla
√Årvore de decis√£o
Random Forest
Regress√£o com Vetores de Suporte
XGBoost
LightGBM
CatBoost
Redes Neurais Artificiais

Iremos realizar testes na base boston heabilitacao da base de dados kaggle

Passos para conhecer o database:
1- Ver o cabecalho head()
2- Ver quantos registros shape

Passos para expolracao, analise e tratamento dos dados:
1- Verificar valores faltantes isnull().sum()
2- Analsar os tipos de atibutos dtypes
3- Dados estatistico descibre() (Verificar se tem valores numericos estranhos como media 0, diferencas muito grandes entre o min e o max)
4- Analise dos outliers utiliazndo bloxpots

CORRELA√á√ÉO LINEAR

Rela√ß√£o linear entre duas vari√°veis.
Determinado atrav√©s de gr√°ficos de dispers√£o e do coeficiente de correla√ß√£o.
Obbjetivo e verificar qual modelo matematico criar para aquela variavel
Observa√ß√£o: Correla√ß√£o n√£o √© causalidade, depor exemplo se aumentar x y diminiu, nao necessariamente esta relaconado a isso.

CORRELA√á√ÉO x CAUSALIDADE -> Nao e a causa dessa relacao
Tem correla√ß√£o, mas a varia√ß√£o de uma vari√°vel n√£o √© a causa da varia√ß√£o da outra vari√°vel.
Deve-se avaliar bem para termos variaveis de um modelo matematigo que de um siginifiacado importante.

r= n*Somatorio xy = Somatirio x * Somatorio y / Raiz x*Somatorio x¬≤ - Somatorio x ¬≤ * Raiz n*Somatorio de y¬≤ - Somatorio de y ^2

Coeficiente de Correla√ß√£o Linear (Coeficiente de Pearson)
Forma mais precisa de medir a correla√ß√£o entre duas grandezas.
Teste Param√©trico (Normalidade).

Coeficiente de correla√ß√£o (r) | Correla√ß√£o Positiva | Coeficiente de correla√ß√£o (r) | Correla√ß√£o Negativa
r = 1 | Perfeita | r = - 1 | Perfeita
0,95 ‚â§ r < 1 | Muito forte | -1 ‚â§ r < -0,95 | Muito forte
0,8 ‚â§ r < 0,95 | Forte | -0,95 ‚â§ r < -0,8 | Forte
0,5 ‚â§ r < 0,8 | Moderada | -0,8 ‚â§ r < -0,5 | Moderada
0, ‚â§ r < 0,5 | Fraca | 0,5 ‚â§ r < -0,8 | Fraca

Corelacoes fracas nao e recomendada para a geracao do modelo, pois nao tera muita precisao.

Coeficiente de determina√ß√£o (r2)
Porcentagem da varia√ß√£o de y que pode ser explicada pela rela√ß√£o de x e y.
Avalia a qualidade do ajuste de um modelo de regress√£o.
ùëü2=ùëê ùëúùëíùëìùëñùëêùëñùëíùëõùë°ùëí ùëëùëí ùëêùëúùëüùëüùëíùëôùëé√ß√£ùëú ùëéùëú ùëûùë¢ùëéùëëùëüùëéùëëùëú

Valida√ß√£o do coeficiente de correla√ß√£o
- Se |r| > valor da tabela: coeficiente significante.
- Se |r| ‚â§ valor da tabela: coeficiente n√£o significante.
Conclus√£o: Como 0,9129 > 0,707, ent√£o o coeficiente √© significante.

Coeficiente de correla√ß√£o de postos de Spearman
Teste N√£o param√©trico.
Medida da for√ßa da rela√ß√£o entre duas vari√°veis.
Pode ser utilizado na rela√ß√£o de dados lineares e tamb√©m n√£o lineares, assim como tamb√©m para dados no n√≠vel ordinal.

C√°lculo do Coeficiente de Spearman
n = n√∫mero amostras.
di = diferen√ßa de alcance de cada elemento.
Coeficiente de correla√ß√£o | Correla√ß√£o Positiva | Coeficiente de correla√ß√£o | Correla√ß√£o Negativa
rR = 1 | Perfeita | rR = - 1 | Perfeita
0,95 ‚â§ rR < 1 | Muito forte | - 1 ‚â§ rR < -0,95 | Muito forte
0,8 ‚â§ rR < 0,95 | Forte | -0,95 ‚â§ rR < -0,8 | Forte
0,5 ‚â§ rR < 0,8 | Moderada | -0,8 ‚â§ rR < -0,5 | Moderada
0 ‚â§ rR < 0,5 | Fraca | -0,5 ‚â§ rR < 0 | Fraca

Coeficiente de correla√ß√£o de Kendall
Teste n√£o param√©trico indicado para n√∫mero pequeno de amostras ou para popula√ß√µes com grandes quantidades de empates (valores repetidos).
Pode ser utilizado juntamente com o Spearman para compara√ß√£o.
√â mais conservador que o teste de Spearman.

C√°lculo do Coeficiente de Kendall
qtd de pares concordantes - quantidade de pares discordantes / n(n-1)/2

Coeficiente de correla√ß√£o | Correla√ß√£o Positiva | Coeficiente de correla√ß√£o | Correla√ß√£o | Negativa
œÑ = 1 | Perfeita | œÑ = - 1 | Perfeita
0,95 ‚â§ œÑ < 1 | Muito forte | - 1 ‚â§ œÑ < -0,95 | Muito forte
0,8 ‚â§ œÑ < 0,95 | Forte | -0,95 ‚â§ œÑ < -0,8 | Forte
0,5 ‚â§ œÑ < 0,8 | Moderada | -0,8 ‚â§ œÑ < -0,5 | Moderada
0 ‚â§ œÑ < 0,5 | Fraca | -0,5 ‚â§ œÑ < 0 | Fraca

Para criar graficos de dispersao utilziza-se a lib matplotlib a funcao scatter
Apos analisar o grafico, devemos analisar a normalidade com analise de graficos qq-plot, histogramas e estatistica shapirowilk (limitado a 5000 registros usar o liliefors caso tiver mais)
Apos feito isso devemos analisar a correlacao linear

Regress√£o Linear -> Aplicar os valores de correlacao
REGRESS√ÉO LINEAR SIMPLES
doc: https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html
lib: from sklearn.linear_model import LinearRegression

Na regressao verifica-se o r¬≤ de metrica, erro absoluto, erro medio absoludo, erro quadratico medio, raiz do erro quadratico medio (usado para comparar com outros modelos)

fit -> realia o treino
predict -> realiza o teste

Modelo matem√°tico linear capaz de realizar previs√µes.
y=m*x+b

y= variavel dependente
m= coeficiente angular
x= variavel dependete eixo x
b= coeficente linear

Utilizado posteriormente √† an√°lise de correla√ß√£o linear.
Equa√ß√£o obtida ap√≥s um ajuste de um reta no gr√°fico de dispers√£o com res√≠duo m√≠nimo (Linha de regress√£o).

Linhas de regress√£o
Linha que melhor se ajusta aos dados plotados, onde a soma dos quadrados dos res√≠duos seja m√≠nima.
d= valor y observado - valor y previsto

Modelo Matem√°tico (Equa√ß√£o da reta) -> Para obetr o valor de y, calculando com os dados em maos, basta usar a formula, mas para calcular sem os dados, precisa calcular:
1- Coeficiente M 
2- Coeficiente B

Podeos avaliar a regressao linear simplse, usando a lib statsmodels, essa avaliacao consite em se esse algoritimo vai ser consistente, satisfatorio ou nao
Testando os residuos se e uma distribuicao noarmal ou nao
Outliers no residos (Entre -3 e 3)

REGRESS√ÉO LINEAR M√öLTIPLA
doc: https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html
lib: from sklearn.linear_model import LinearRegression

Quando possui mais de uma vari√°vel independente.
ùë¶ =ùëè0 + ùëè1 ùë•1+ ùëè2 ùë•2 +‚Ä¶ +ùëèùëõ ùë•ùëõ +ùúÄ(erro)

Utiliza-se o m√©todo dos m√≠nimos quadrados para estimar os coeficientes da regress√£o m√∫ltipla, sendo que o ideal √© usar a tecnologia.
Ap√≥s a obten√ß√£o dos coeficientes e, consequentemente, a equa√ß√£o da regress√£o linear m√∫ltipla, a√≠ sim ser√° poss√≠vel a realiza√ß√£o das previs√µes.

Pressupostos
1. Rela√ß√£o linear entre vari√°veis independentes e dependentes.
2. Sem presen√ßa de outliers na an√°lise dos res√≠duos.
3. Passar no teste de homocedasticidade.
4. Res√≠duos normalmente distribu√≠dos com m√©dia 0 e vari√¢ncia constante.
5. Aus√™ncia de multicolinearidade e autocorrela√ß√£o.

Podeos avaliar a regressao linear simplse, usando a lib statsmodels, essa avaliacao consite em se esse algoritimo vai ser consistente, satisfatorio ou nao
Testando os residuos se e uma distribuicao noarmal ou nao
Outliers no residos (Entre -3 e 3)
Multicolinariedade r>0.9

REGRESS√ÉO POLINOMIAL
doc: https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html
lib: from sklearn.preprocessing import PolynomialFeatures

Ajuste de uma equa√ß√£o n√£o linear por meio de fun√ß√µes polinomiais de vari√°vel independente.

Ponto Cr√≠tico
Pontos de m√°ximo e de m√≠nimo da fun√ß√£o.
Para achar o ponto critico, calcula-se a derivada de y, derivada de x e iguala a zero

REGRESS√ÉO POR VETORES DE SUPORTE
doc: https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html
Parametro mais importante: kernel
Deve-se realizar a padronizacao de escala

REGRESS√ÉO COM √ÅRVORE DE DECIS√ÉO
doc: https://scikit-learn.org/stable/modules/tree.html#regression
Parametros principais: profundidade e random_state

REGRESS√ÉO COM RANDOM FOREST
doc: https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html
Parametros principais: n_estimators(arvores), criterion, max_depth, random_state

REGRESS√ÉO COM XGBOOST
doc: https://xgboost.readthedocs.io/en/latest/python/python_api.html#xgboost.XGBRegressor
Parametros principais: n_estimators(arvores), max_depth, learning_rate, objective

REGRESS√ÉO COM LIGHT GBM
doc: https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.LGBMRegressor.html
Parametros principais: num_leaves, max_depth, learning_Rate, n_estimators

REGRESS√ÉO COM CATBOOST
doc: https://catboost.ai/en/docs/concepts/python-reference_catboostregressor
Parametros principais: iterations, learning_rate, depth, rando_state

DESAFIO 2:
DESENVOLVER E SELECIONAR O MELHOR ALGORITMO DE MACHINE LEARNING DE REGRESS√ÉO PARA O DATASET DO LINK A SEGUIR:

https://www.kaggle.com/mirichoi0218/insurance/code

OS ALGORITIMOS QUE UTILIZAREMOS SERAO:
1- REGRESS√ÉO LINEAR SIMPLES
2- REGRESS√ÉO LINEAR M√öLTIPLA
3- REGRESS√ÉO POLINOMIAL
4- REGRESS√ÉO POR VETORES DE SUPORTE
5- REGRESS√ÉO COM √ÅRVORE DE DECIS√ÉO
6- REGRESS√ÉO COM RANDOM FOREST
7- REGRESS√ÉO COM XGBOOST
8- REGRESS√ÉO COM LIGHT GBM
9- REGRESS√ÉO COM CATBOOST

Resolucao deste desafio estara no repositorio do github no link: https://github.com/dyego-hcb/script-regression-dataset-kaggle-medical-cost-personal
